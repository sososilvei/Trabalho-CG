<!DOCTYPE html>
<html>

<head>
<title>Welcome to Space</title>
    
    <link rel = "stylesheet" href = "./webglbook.css" />
    <link rel="shortcut icon" type="image/png" href="./lego_space.png"/>
    <script src="../libs/three.js"></script>
    <script src="../libs/RequestAnimationFrame.js"></script>
    <script src="../libs/OBJLoader.js"></script>
    <script>
        var render = null,
            scene = null,
            camera = null,
            cube = null,
            obj_carregado = new THREE.Mesh(),
            animating = false;
        
        function onLoad()
        {
            // Grabs our container div
            var container = document.getElementById("container");
            
            // Creates the Three.js renderer, add it to our div
            renderer = new THREE.WebGLRenderer({antialias: true});
            renderer.setSize(container.offsetWidth, container.offsetHeight);
            container.appendChild(renderer.domElement);
            
            // Creates a new Three.js scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color( 0x000000 );
            
            // Puts in a camera
            camera = new THREE.PerspectiveCamera(45, container.offsetWidth / container.offsetHeight, 1, 4000);
            camera.position.set(0, 0, 3);
            
            // Creates a directional light to show off the object
            var light = new THREE.DirectionalLight(0xffffff, 1.5);
            light.position.set(0, 0 ,1);
            scene.add(light);
            
            // Creates a Phong material to show shading; pass in the map
            var material = new THREE.MeshPhongMaterial({ map:map }); 
            
            // Instantiates a loader
            var loader = new THREE.OBJLoader();
            // Loads a resource
            loader.load(
                'Spaceship.obj',
                // Called when resource is loaded
                function ( object ) {
                    obj_carregado = object;
				    object.position.x = 0;
				    object.position.y = 0;
				    object.position.z = -10;
				    object.scale.set(0.6,0.6,0.6);
                    scene.add( object );
                });
            
            // Turns it toward the scene to visualize the spaceship shape
            obj_carregado.rotation.x = Math.PI / 5;
            obj_carregado.rotation.y = Math.PI / 5;
            
            // Adds a mouse up handler to toggle the animation
            addMouseHandler();
            
            // Runs our render loop
            run();
        }
        
        function run()
        {
            // Renders the scene
            renderer.render(scene, camera);
            
            // Spins the spaceship for next frame
            if (animating)
            {
                obj_carregado.rotation.z -= 0.008;  
                obj_carregado.rotation.y -= 0.011;
                obj_carregado.rotation.x -= 0.001;
                obj_carregado.translateZ (-0.04);
                
            }
            
            // Asks for another frame
            requestAnimationFrame(run);
        }
        
        function addMouseHandler()
        {
            var dom = renderer.domElement;
            dom.addEventListener('mouseup', onMouseUp, false);
        }
        
        function onMouseUp ()
        {
            event.preventDefault();
            animating = !animating;
        }
    </script>

</head>
    
<body onLoad="onLoad();" style="">
    <center><h1>Welcome to Space!</h1></center>
    <div id="container"
         style="width:99%; height:80%; position:absolute;">
    </div>
    <div id="prompt"
        style="width:95%; height:6%; bottom:0; position:absolute;">
        Click to animate the spaceship
    </div>
</body>
    
</html>